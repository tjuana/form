import{r as u,j as n,u as j,s as P}from"./index-CBhtekP8.js";import{c as w,u as C,a as E,B as F,t as v}from"./hooks-B2U4e3b5.js";const g=(e,t,a=!1)=>{const[r,s]=u.useState(),[i,o]=u.useState(a);return u.useEffect(()=>{i&&s(t(e))},[e,i,t]),{error:r,onBlur:()=>o(!0),markTouched:()=>o(!0)}},y=e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?void 0:"Invalid email format":"Email is required",S=e=>{if(!e)return"Password is required";if(e.length<8)return"Password must be at least 8 characters";if(!/[A-Z]/.test(e))return"Password must include at least one uppercase letter";if(!/[a-z]/.test(e))return"Password must include at least one lowercase letter";if(!/[0-9]/.test(e))return"Password must include at least one digit";if(!/[!@#$%^&*(),.?":{}|<>]/.test(e))return"Password must include a special character"},L=[{email:"test@example.com",password:"StrongPass1!",name:"Test User"},{email:"test2@example.com",password:"StrongPass2!",name:"Test User 2"},{email:"admin@example.com",password:"StrongPass3!",name:"Admin User"}],V=e=>new Promise(t=>setTimeout(t,e)),T=async({email:e,password:t})=>{await V(713);const a=L.find(r=>r.email===e&&r.password===t);if(!a)throw new Error("Invalid email or password");return a},I=({id:e,label:t,value:a,onChange:r,error:s,type:i="text",onBlur:o,onFocus:l,autoComplete:d="off",autoFocus:m=!1})=>{const[p,c]=u.useState(!1),h=p||a.length>0;return n.jsxs("div",{className:"mb-4 relative",children:[n.jsx("input",{id:e,type:i,value:a,onChange:x=>r(x.target.value),onFocus:()=>{c(!0),l==null||l()},onBlur:()=>{c(!1),o==null||o()},"aria-invalid":!!s,"aria-describedby":s?`${e}-error`:void 0,className:w("peer w-full px-3 pt-6 pb-2 text-sm border rounded-md shadow-sm focus:outline-none transition-all",s?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500"),placeholder:" ",autoComplete:d,autoFocus:m}),n.jsx("label",{htmlFor:e,className:w("absolute left-3 text-gray-500 text-sm transition-all pointer-events-none",h?"top-1 text-xs":"top-3.5"),children:t}),n.jsx("p",{id:`${e}-error`,className:w("text-sm mt-1",s?"text-red-500":"invisible h-5"),children:s??"placeholder"})]})},N=[{id:"email",label:"Email",type:"email",autoComplete:"email",autoFocus:!0},{id:"password",label:"Password",type:"password",autoComplete:"current-password",autoFocus:!1}],B=({values:e,handleChange:t,errors:a,onBlurs:r})=>n.jsx(n.Fragment,{children:N.map(s=>n.jsx(I,{id:s.id,label:s.label,value:e[s.id],onChange:t(s.id),error:a[s.id],type:s.type,autoComplete:s.autoComplete,onBlur:r[s.id],autoFocus:s.autoFocus},s.id))}),k=e=>{const[t,a]=u.useState(e);return{values:t,handleChange:i=>o=>{a(l=>({...l,[i]:o}))},setValue:(i,o)=>{a(l=>({...l,[i]:o}))}}},A=()=>{const{values:e,handleChange:t}=k({email:"",password:""}),a=g(e.email,y),r=g(e.password,S);return{values:e,handleChange:t,errors:{email:a.error,password:r.error},onBlurs:{email:a.onBlur,password:r.onBlur}}},q=()=>{const[e,t]=u.useState(!1),a=C(),r=E(b=>b.auth.user!==null),{values:s,handleChange:i,errors:o,onBlurs:l}=A(),{email:d,password:m}=s,p=g(d,y),c=g(m,S),h=j();u.useEffect(()=>{r&&h("/dashboard")},[r,h]);const x=async b=>{if(b.preventDefault(),p.markTouched(),c.markTouched(),p.error||c.error){v.error("Fix validation errors before submitting");return}t(!0);try{const f=await T({email:d,password:m});a(P(f)),v.success("Login successful")}catch(f){v.error(f instanceof Error?f.message:"Login failed");return}finally{t(!1)}};return n.jsxs("form",{onSubmit:x,className:"flex flex-col max-w-sm md:max-w-md mx-auto container border border-gray-300 rounded-md p-4 shadow-md mt-20",role:"form",noValidate:!0,children:[n.jsx("h2",{id:"form-heading",className:"text-xl font-semibold mb-4",children:"Sign In"}),n.jsx(B,{values:s,handleChange:i,errors:o,onBlurs:l}),n.jsx(F,{type:"submit",loading:e,fullWidth:!0,ariaLabel:"Login",children:"Login"})]})};export{q as default};
