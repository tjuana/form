import{r as u,j as l,u as E,a as V,s as C}from"./index-jadRRisZ.js";import{c as S,t as x,u as F,a as L,B as T}from"./Button-C8fqTW3i.js";const b=[{email:"test@example.com",password:"StrongPass1!",name:"Test User"},{email:"test2@example.com",password:"StrongPass2!",name:"Test User 2"},{email:"admin@example.com",password:"StrongPass3!",name:"Admin User"}],I=e=>new Promise(t=>setTimeout(t,e)),N=async({email:e,password:t})=>{await I(713);const r=b.find(a=>a.email===e&&a.password===t);if(!r)throw new Error("Invalid email or password, use /?demo=1 or /?demo=2 or /?demo=3 to login as Test User, Test User 2 or Admin User");return r},w=(e,t,r=!1)=>{const[a,s]=u.useState(),[n,o]=u.useState(r);return u.useEffect(()=>{n&&s(t(e))},[e,n,t]),{error:a,onBlur:()=>o(!0),markTouched:()=>o(!0)}},j=e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?void 0:"Invalid email format":"Email is required",y=e=>{if(!e)return"Password is required";if(e.length<8)return"Password must be at least 8 characters";if(!/[A-Z]/.test(e))return"Password must include at least one uppercase letter";if(!/[a-z]/.test(e))return"Password must include at least one lowercase letter";if(!/[0-9]/.test(e))return"Password must include at least one digit";if(!/[!@#$%^&*(),.?":{}|<>]/.test(e))return"Password must include a special character"},U=({id:e,label:t,value:r,onChange:a,error:s,type:n="text",onBlur:o,onFocus:i,autoComplete:c="off",autoFocus:m=!1})=>{const[p,d]=u.useState(!1),f=p||r.length>0;return l.jsxs("div",{className:"mb-4 relative",children:[l.jsx("input",{id:e,type:n,value:r,onChange:h=>a(h.target.value),onFocus:()=>{d(!0),i==null||i()},onBlur:()=>{d(!1),o==null||o()},"aria-invalid":!!s,"aria-describedby":s?`${e}-error`:void 0,className:S("peer w-full px-3 pt-6 pb-2 text-sm border rounded-md shadow-sm focus:outline-none transition-all",s?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500"),placeholder:" ",autoComplete:c,autoFocus:m}),l.jsx("label",{htmlFor:e,className:S("absolute left-3 text-gray-500 text-sm transition-all pointer-events-none",f?"top-1 text-xs":"top-3.5"),children:t}),l.jsx("p",{id:`${e}-error`,className:S("text-sm mt-1",s?"text-red-500":"invisible h-5"),children:s??"placeholder"})]})},A=[{id:"email",label:"Email",type:"email",autoComplete:"email",autoFocus:!0},{id:"password",label:"Password",type:"password",autoComplete:"current-password",autoFocus:!1}],B=({values:e,handleChange:t,errors:r,onBlurs:a})=>l.jsx(l.Fragment,{children:A.map(s=>l.jsx(U,{id:s.id,label:s.label,value:e[s.id],onChange:t(s.id),error:r[s.id],type:s.type,autoComplete:s.autoComplete,onBlur:a[s.id],autoFocus:s.autoFocus},s.id))}),$=e=>{const[t,r]=u.useState(e);return{values:t,handleChange:n=>o=>{r(i=>({...i,[n]:o}))},setValue:(n,o)=>{r(i=>({...i,[n]:o}))}}},k=()=>{const{values:e,handleChange:t,setValue:r}=$({email:"",password:""}),a=w(e.email,j),s=w(e.password,y);return{values:e,handleChange:t,errors:{email:a.error,password:s.error},onBlurs:{email:a.onBlur,password:s.onBlur},setValue:r}},D=({values:e,setValue:t})=>{const[r]=E();u.useEffect(()=>{const a=r.get("demo"),s=Number(a);if(a&&!b[s]){x.error("Invalid demo number, use /?demo=0 or /?demo=1 or /?demo=2");return}if(a&&e.email===""&&e.password===""&&b[s]){const n=b[s];Object.entries(n).forEach(([o,i])=>{o in e&&t(o,i)})}},[r,t,e])},O=()=>{const[e,t]=u.useState(!1),r=F(),a=L(v=>v.auth.user!==null),{values:s,handleChange:n,errors:o,onBlurs:i,setValue:c}=k(),{email:m,password:p}=s,d=w(m,j),f=w(p,y),h=V();D({values:s,setValue:c}),u.useEffect(()=>{a&&h("/dashboard")},[a,h]);const P=async v=>{if(v.preventDefault(),d.markTouched(),f.markTouched(),d.error||f.error){x.error("Fix validation errors before submitting");return}t(!0);try{const g=await N({email:m,password:p});r(C(g)),x.success("Login successful")}catch(g){x.error(g instanceof Error?g.message:"Login failed");return}finally{t(!1)}};return l.jsxs("form",{onSubmit:P,className:"flex flex-col max-w-sm md:max-w-md mx-auto container border border-gray-300 rounded-md p-4 shadow-md mt-20",role:"form",noValidate:!0,children:[l.jsx("h2",{id:"form-heading",className:"text-xl font-semibold mb-4",children:"Sign In"}),l.jsx(B,{values:s,handleChange:n,errors:o,onBlurs:i}),l.jsx(T,{type:"submit",loading:e,fullWidth:!0,ariaLabel:"Login",children:"Login"})]})};export{O as default};
